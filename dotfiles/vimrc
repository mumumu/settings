"
"  mumumu's ~/.vimrc setting
"
"  How to setup(in Ubuntu 14.04):
"
"  $ sudo apt-get install vim-nox git build-essential
"  $ git clone https://github.com/Shougo/neobundle.vim.git ~/.vim/neobundle.vim.git "
"  :NeoBundleInstall
"  :NeoBundleInstall!
"

"
"  for neobundle setting
"

" Note: Skip initialization for vim-tiny or vim-small.
if 0 | endif

if &compatible
  set nocompatible               " Be iMproved
endif

" Required:
set runtimepath+=~/.vim/bundle/neobundle.vim/

" Required:
call neobundle#begin(expand('~/.vim/bundle/'))

" Let NeoBundle manage NeoBundle
" Required:
NeoBundleFetch 'Shougo/neobundle.vim'

" My Bundles here:
" Refer to |:NeoBundle-examples|.
" Note: You don't set neobundle setting in .gvimrc!

call neobundle#end()

" Required:
filetype plugin indent on

" If there are uninstalled bundles found on startup,
" this will conveniently prompt you to install them.
NeoBundleCheck

call neobundle#begin(expand('~/.vim/bundle/'))
NeoBundle 'Shougo/neobundle.vim'
NeoBundle 'nvie/vim-flake8'
NeoBundle 'tpope/vim-fugitive'
NeoBundle 'puppetlabs/puppet-syntax-vim'
NeoBundle 'fuenor/im_control.vim'
call neobundle#end()

" Syntax
syntax on
hi Comment ctermfg=LightBlue
hi String ctermfg=LightRed
hi Number ctermfg=LightRed
hi boolean ctermfg=LightRed
hi Character ctermfg=LightRed
hi Statement ctermfg=LightYellow
set background=dark

" commands
set fileencoding=utf-8
set fileformat=unix
set noexpandtab
set shiftwidth=4
set tabstop=4
set shiftwidth=4
set hidden
set shell=/bin/bash\ -l\ -O\ expand_aliases
set autoindent
set paste
set splitright
set nohlsearch

set number
:command Nn set nonumber
:command NN set number

"
"  for Python
"
"  http://www.vim.org/scripts/script.php?script_id=1542
"  https://github.com/nvie/vim-flake8
autocmd BufWrite *.py :call Flake8()

"
"  no backup
"
set noswapfile
set nobackup

"
"  status line
"  http://www.ksknet.net/vi/statusline.html
"
set laststatus=2
set statusline=%<%F\ %m%r%h%w
set statusline+=%{'['.(&fenc!=''?&fenc:&enc).']['.&fileformat.']['.&filetype.']'}
set statusline+=%{fugitive#statusline()}
set statusline+=%=%l/%L,%c%V%8P

"
"  command alias for ranger
"
let g:ranger_cwd = getcwd()

function! RangeChooser()
    let temp = tempname()
    let ranger_cwd_files = system("ls -lart | grep types.py")
    if strlen(ranger_cwd_files) > 0
        g:ranger_cwd = system("dirname `dirname " . g:ranger_cwd . '`')   
    endif
    " The option "--choosefiles" was added in ranger 1.5.1. Use the next line
    " with ranger 1.4.2 through 1.5.0 instead.
    "exec 'silent !ranger --choosefile=' . shellescape(temp)
    exec 'silent !ranger --choosefiles=' . shellescape(temp) . ' ' . g:ranger_cwd
    if !filereadable(temp)
        " Nothing to read.
        return
    endif
    let names = readfile(temp)
    echo names
    if empty(names)
        " Nothing to open.
        return
    endif
    " Edit the first item.
    exec 'vsplit ' . fnameescape(names[0])
    " Add any remaning items to the arg list/buffer list.
    for name in names[1:]
        exec 'argadd ' . fnameescape(name)
    endfor
    let g:ranger_cwd = fnamemodify(expand(names[0]), ":h")
    redraw!
endfunction
command! -bar RangerChooser call RangeChooser()
nnoremap <leader>r :<C-U>RangerChooser<CR>
